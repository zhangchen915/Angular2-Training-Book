<!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">

    <title>Angular Training Book |  </title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <!-- fonts -->
    <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet">
    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,600,700" rel="stylesheet">

    <!-- stylesheets -->
    <link rel="stylesheet" href="/style/doc.css">

    <!-- favicon -->
    <link rel="icon" href="/images/favicon.ico">

    

  </head>
  <body>

   <script>window.__INITIAL_STATE__ = {"page":{"path":"zone/tasks.html","title":""},"data":{"navigation":{"logo":{"text":"Angular","type":"link","path":"index.html"},"main":[{"text":"License","type":"link","path":"license.html"},{"text":"Why Angular ? ","type":"link","path":"why_angular_2.html"},{"text":"为什么不是React⚡️","type":"link","path":"vs_react.html"},{"text":"聊聊技术选型-Angular vs Vue⚡️","type":"link","path":"vs_vue2.html"},{"text":"ES6和TypeScript的特点","type":"link","path":"ES6&TypeScript/ES6&TypeScript.html","children":[{"text":"ES6","type":"link","path":"ES6&TypeScript/es6/es6.html"},{"text":"Classes","type":"link","path":"ES6&TypeScript/es6/classes.html"},{"text":"回顾 `this`","type":"link","path":"ES6&TypeScript/es6/refresher_on_this.html"},{"text":"箭头函数","type":"link","path":"ES6&TypeScript/es6/arrow_functions.html"},{"text":"模板字符串","type":"link","path":"ES6&TypeScript/es6/template_strings.html"},{"text":"继承","type":"link","path":"ES6&TypeScript/es6/inheritance.html"},{"text":"委托","type":"link","path":"ES6&TypeScript/es6/delegation.html"},{"text":"常量和块作用域变量","type":"link","path":"ES6&TypeScript/es6/constants_and_block_scoped_variables.html"},{"text":"扩展语句和剩余参数","type":"link","path":"ES6&TypeScript/es6/spread_and_rest.html"},{"text":"解构","type":"link","path":"ES6&TypeScript/es6/destructuring.html"},{"text":"模块","type":"link","path":"ES6&TypeScript/es6/es6_modules.html"},{"text":"TypeScript","type":"link","path":"ES6&TypeScript/typescript/typeScript.html"},{"text":"TypeScript入门","type":"link","path":"ES6&TypeScript/typescript/typeScript_start.html"},{"text":"使用 tsc","type":"link","path":"ES6&TypeScript/typescript/working_with_tsc.html"},{"text":"Linting","type":"link","path":"ES6&TypeScript/typescript/linting.html"},{"text":"类型⚡️","type":"link","path":"ES6&TypeScript/typescript/typings.html"},{"text":"TypeScript特性","type":"link","path":"ES6&TypeScript/typescript/typescript_features.html"},{"text":"TypeScript类","type":"link","path":"ES6&TypeScript/typescript/typescript_classes.html"},{"text":"泛型⚡️","type":"link","path":"ES6&TypeScript/typescript/generics.html"},{"text":"接口","type":"link","path":"ES6&TypeScript/typescript/interfaces.html"},{"text":"Shapes","type":"link","path":"ES6&TypeScript/typescript/shapes.html"},{"text":"类型推断","type":"link","path":"ES6&TypeScript/typescript/type_inference.html"},{"text":"类型关键字","type":"link","path":"ES6&TypeScript/typescript/type_keyword.html"},{"text":"装饰器","type":"link","path":"ES6&TypeScript/typescript/decorators.html"},{"text":"属性装饰器","type":"link","path":"ES6&TypeScript/typescript/property_decorators.html"},{"text":"类装饰器","type":"link","path":"ES6&TypeScript/typescript/class_decorators.html"},{"text":"参数装饰器","type":"link","path":"ES6&TypeScript/typescript/parameter_decorators.html"}]},{"text":"JavaScript工具链","type":"link","path":"tooling/tooling.html","children":[{"text":"源码控制： Git","type":"link","path":"tooling/source_control.html"},{"text":"命令行","type":"link","path":"tooling/the_command_line.html"},{"text":"JavaScript命令行： NodeJS","type":"link","path":"tooling/command_line_javascript.html"},{"text":"后端代码共享和分发： npm","type":"link","path":"tooling/back_end_code_sharing_and_distribution.html"},{"text":"模块加载， 打包和构建任务： Webpack","type":"link","path":"tooling/module_loading_bundling_and_build_tasks.html"},{"text":"Chrome","type":"link","path":"tooling/chrome.html"}]},{"text":"引导Angular应用","type":"link","path":"bootstrapping/bootstrapping.html","children":[{"text":"了解文件结构","type":"link","path":"bootstrapping/file_structure.html"},{"text":"引导Providers","type":"link","path":"bootstrapping/bootstrapping_providers.html"}]},{"text":"Angular 中的组件","type":"link","path":"Components/components.html","children":[{"text":"创建组件","type":"link","path":"Components/creating_components.html"},{"text":"组件的应用程序结构","type":"link","path":"Components/app_structure_with_components.html","children":[{"text":"将数据传递到组件","type":"link","path":"Components/passing_data_into_components.html"},{"text":"响应组件事件","type":"link","path":"Components/responding_to_component_events.html"},{"text":"使用双向数据绑定","type":"link","path":"Components/two_way_data_binding.html"},{"text":"从模板访问子组件","type":"link","path":"Components/access_child_components_from_template.html"}]},{"text":"投影","type":"link","path":"Components/projection.html"},{"text":"使用组件构建应用程序","type":"link","path":"Components/structuring_applications_with_components.html"},{"text":"使用其他组件","type":"link","path":"Components/using_other_components.html"}]},{"text":"指令","type":"link","path":"Directives/directives.html","children":[{"text":"属性指令","type":"link","path":"Directives/attribute_directives.html","children":[{"text":"NgStyle指令","type":"link","path":"Directives/ng_style_directive.html"},{"text":"NgClass指令","type":"link","path":"Directives/ng_class_directive.html"}]},{"text":"结构指令","type":"link","path":"Directives/structural_directives.html","children":[{"text":"NgIf指令","type":"link","path":"Directives/ng_if_directive.html"},{"text":"NgFor指令","type":"link","path":"Directives/ng_for_directive.html"},{"text":"NgSwitch指令","type":"link","path":"Directives/ng_switch_directives.html"},{"text":"使用多个结构指令","type":"link","path":"Directives/using_multiple_structural_directives.html"}]}]},{"text":"高级组件","type":"link","path":"advanced-components/advanced-components.html","children":[{"text":"组件生命周期","type":"link","path":"advanced-components/component_lifecycle.html"},{"text":"其他组件交互方式","type":"link","path":"advanced-components/access_child_components.html"},{"text":"视图封装","type":"link","path":"advanced-components/view_encapsulation.html"},{"text":"ElementRef","type":"link","path":"advanced-components/elementref.html"}]},{"text":"Observable","type":"link","path":"Observables/observables.html","children":[{"text":"使用Observable","type":"link","path":"Observables/using_observables.html"},{"text":"错误处理","type":"link","path":"Observables/error_handling.html"},{"text":"处理订阅和释放资源","type":"link","path":"Observables/disposing_subscriptions_and_releasing_resources.html"},{"text":"Observable VS Promise","type":"link","path":"Observables/observables_vs_promises.html"},{"text":"使用其他来源的Observable","type":"link","path":"Observables/using_observables_from_other_sources.html"},{"text":"可观察数组操作","type":"link","path":"Observables/observables_array_operations.html"},{"text":"“冷” vs“ 热” Observable","type":"link","path":"Observables/cold_vs_hot_observables.html"},{"text":"总结","type":"link","path":"Observables/summary.html"}]},{"text":"Angular 依赖注入","type":"link","path":"Di/di.html","children":[{"text":"什么是DI？","type":"link","path":"Di/what_is_di.html"},{"text":"DI框架","type":"link","path":"Di/di_framework.html"},{"text":"Angular 的DI","type":"link","path":"Di/angular2_di.html","children":[{"text":"@Inject() 和 @Injectable","type":"link","path":"Di/inject_and_injectable.html"},{"text":"类以外的注入","type":"link","path":"Di/injection_beyond_classes.html"},{"text":"避免注入冲突: OpaqueToken","type":"link","path":"Di/avoiding_collisions_opaque_token.html"},{"text":"注入树","type":"link","path":"Di/the_injector_tree.html"}]}]},{"text":"HTTP","type":"link","path":"Http/http.html","children":[{"text":"发起请求","type":"link","path":"Http/making_requests.html"},{"text":"捕获异常","type":"link","path":"Http/catching-rejections.html","children":[{"text":"捕获和释放","type":"link","path":"Http/catch_and_release.html"},{"text":"取消请求","type":"link","path":"Http/cancel_request.html"},{"text":"重试","type":"link","path":"Http/retry.html"}]},{"text":"拦截请求","type":"link","path":"Http/interceptor.html"},{"text":"进度事件","type":"link","path":"Http/progress.html"}]},{"text":"变化检测","type":"link","path":"Change-detection/Change_Detection.html","children":[{"text":"Angularjs与Angular的变化检测策略","type":"link","path":"Change-detection/angular_1_vs_angular_2.html"},{"text":"变化检测如何工作","type":"link","path":"Change-detection/how_change_detection_works.html"},{"text":"更改检测器类","type":"link","path":"Change-detection/change_detector_classes.html"},{"text":"变更检测策略： OnPush","type":"link","path":"Change-detection/change_detection_strategy_onpush.html"},{"text":"强制不变性","type":"link","path":"Change-detection/enforcing_immutability.html"},{"text":"其他资源","type":"link","path":"Change-detection/additional_resources.html"}]},{"text":"Zone.js","type":"link","path":"zone/zone.html","children":[{"text":"概述","type":"link","path":"zone/zone_primer.html"},{"text":"Zone 传播","type":"link","path":"zone/zone-propagation.html"},{"text":"跟踪异步操作","type":"link","path":"zone/tracking_async_operations.html"},{"text":"异步操作补丁","type":"link","path":"zone/patching_async_methods.html"},{"text":"上下文环境","type":"link","path":"zone/context_propagation.html"},{"text":"拦截","type":"link","path":"zone/interception.html"}]},{"text":"Angular 进阶","type":"link","path":"Advanced-angular/advanced-angular.html","children":[{"text":"指令","type":"link","path":"Advanced-angular/directives.html","children":[{"text":"创建属性指令","type":"link","path":"Advanced-angular/creating_an_attribute_directive.html","children":[{"text":"监听Host元素","type":"link","path":"Advanced-angular/listening_to_an_element_host.html"},{"text":"在指令中设置属性","type":"link","path":"Advanced-angular/setting_properties_in_a_directive.html"}]},{"text":"创建结构指令","type":"link","path":"Advanced-angular/creating_a_structural_directive.html","children":[{"text":"查看容器和嵌入视图","type":"link","path":"Advanced-angular/view_containers_and_embedded_views.html"},{"text":"向指令提供上下文变量","type":"link","path":"Advanced-angular/providing_context_variables_to_directives.html"}]}]},{"text":"AoT","type":"link","path":"Advanced-angular/aot.html","children":[{"text":"AoT局限","type":"link","path":"Advanced-angular/aot_limitations.html"},{"text":"AoT配置","type":"link","path":"Advanced-angular/aot_config.html"}]}]},{"text":"Immutable.js","type":"link","path":"Immutable/immutable.html","children":[{"text":"什么是不可变性？","type":"link","path":"Immutable/what_is_immutability.html"},{"text":"不变性的应用场景","type":"link","path":"Immutable/the_case_for_immutability.html"},{"text":"JavaScript解决方案","type":"link","path":"Immutable/javascript-solutions.html"},{"text":"Object.assign","type":"link","path":"Immutable/object_assign.html"},{"text":"Object.freeze","type":"link","path":"Immutable/object_freeze.html"},{"text":"Immutable.js基础","type":"link","path":"Immutable/immutable-js.html","children":[{"text":"Immutable.Map","type":"link","path":"Immutable/maps.html"},{"text":"Map.merge","type":"link","path":"Immutable/map_merge.html"},{"text":"嵌套对象","type":"link","path":"Immutable/nested-objects.html"},{"text":"删除密钥","type":"link","path":"Immutable/deleting_keys.html"},{"text":"Map是可迭代的","type":"link","path":"Immutable/maps_are_iterable.html"},{"text":"Immutable.List","type":"link","path":"Immutable/lists.html"},{"text":"性能和瞬态变化","type":"link","path":"Immutable/performance-transient-changes.html"},{"text":"官方文件","type":"link","path":"Immutable/official-documentation.html"}]}]},{"text":"管道","type":"link","path":"Pipes/pipes.html","children":[{"text":"使用管道","type":"link","path":"Pipes/using_pipes.html"},{"text":"自定义管道","type":"link","path":"Pipes/custom_pipes.html"},{"text":"状态管道","type":"link","path":"Pipes/stateful_and_async_pipes.html"}]},{"text":"表单","type":"link","path":"Form/form.html","children":[{"text":"入门","type":"link","path":"Form/getting-started.html"},{"text":"模板驱动的表单","type":"link","path":"Form/template-driven_forms.html","children":[{"text":"嵌套表单数据","type":"link","path":"Form/nested-form-data.html"},{"text":"使用模板模型绑定","type":"link","path":"Form/template-model-binding.html"},{"text":"验证模板驱动的表单","type":"link","path":"Form/validating_forms.html"}]},{"text":"响应式/模型驱动的表单","type":"link","path":"Form/reactive-forms.html","children":[{"text":"响应式表单基础","type":"link","path":"Form/reactive-forms_basics.html"},{"text":"验证响应式表单","type":"link","path":"Form/reactive-forms_validation.html"},{"text":"自定义验证响应式表单","type":"link","path":"Form/reactive-forms_custom_validation.html"}]},{"text":"用户的视觉提示","type":"link","path":"Form/visual_cues_for_users.html"}]},{"text":"模块","type":"link","path":"Modules/modules.html","children":[{"text":"什么是Angular模块？","type":"link","path":"Modules/introduction.html"},{"text":"将组件、 管道和服务添加到模块","type":"link","path":"Modules/multiple-elements.html"},{"text":"创建功能模块","type":"link","path":"Modules/feature-modules.html"},{"text":"指令复制","type":"link","path":"Modules/directive-duplications.html"},{"text":"延迟加载模块","type":"link","path":"Modules/lazy-loading-module.html"},{"text":"延迟加载和依赖注入树","type":"link","path":"Modules/lazy-load-di.html"},{"text":"共享模块和依赖注入","type":"link","path":"Modules/shared-modules-di.html"},{"text":"共享相同的依赖注入树","type":"link","path":"Modules/shared-di-tree.html"}]},{"text":"路由","type":"link","path":"Routing/routing.html","children":[{"text":"为什么选择路由？","type":"link","path":"Routing/why_routing.html"},{"text":"配置路由","type":"link","path":"Routing/config.html"},{"text":"将路由器重定向到另一条路由","type":"link","path":"Routing/redirects.html"},{"text":"定义路由之间的链接","type":"link","path":"Routing/routerlink.html"},{"text":"动态添加路由组件","type":"link","path":"Routing/routeroutlet.html"},{"text":"使用路由参数","type":"link","path":"Routing/routeparams.html"},{"text":"定义子路由","type":"link","path":"Routing/child_routes.html"},{"text":"路由拦截","type":"link","path":"Routing/route_guards.html"},{"text":"将可选参数传递给路由","type":"link","path":"Routing/query_params.html"},{"text":"使用辅助路由","type":"link","path":"Routing/aux-routes.html"}]},{"text":"状态管理","type":"link","path":"state-management/state-management.html","children":[{"text":"Redux 和 @ngrx","type":"link","path":"statemanagement/Redux.html"},{"text":"将 @ngrx添加到你的项目","type":"link","path":"statemanagement/adding_ngrx_to_your_project.html"},{"text":"定义应用的主状态","type":"link","path":"statemanagement/defining_your_main_application_state.html"},{"text":"示例应用","type":"link","path":"state-management/example_application.html"},{"text":"使用选择器读取应用程序状态","type":"link","path":"state-management/reading_your_application_state_using_selectors.html"},{"text":"Actions","type":"link","path":"state-management/actions.html"},{"text":"通过Dispatching Actions 修改应用 State","type":"link","path":"state-management/modifying_your_application_state_by_dispatching_actions.html"},{"text":"Reducers 和纯函数","type":"link","path":"state-management/reducers_and_pure_functions.html"},{"text":"Reducers 的 State 管理","type":"link","path":"state-management/reducers_as_state_management.html"},{"text":"创建应用的Root Reducer","type":"link","path":"state-management/creating_your_applications_root_reducer.html"},{"text":"配置你的应用","type":"link","path":"state-management/configuring_your_application.html"},{"text":"更多Redux和Ngrx资源","type":"link","path":"state-management/getting_more_from_redux_and_ngrx.html"}]},{"text":"动画","type":"link","path":"animation/index.html"},{"text":"TDD测试","type":"link","path":"Testing/testing.html","children":[{"text":"测试工具链","type":"link","path":"Testing/toolchain.html"},{"text":"测试设置","type":"link","path":"Testing/setup.html","children":[{"text":"文件名约定","type":"link","path":"Testing/filename-conventions.html"},{"text":"Karma配置","type":"link","path":"Testing/karma-config.html"},{"text":"TestBed配置（ 可选）","type":"link","path":"Testing/testbed-configuration.html"},{"text":"类型","type":"link","path":"Testing/typings.html"},{"text":"执行测试脚本","type":"link","path":"Testing/execute.html"}]},{"text":"简单测试","type":"link","path":"Testing/simple-test.html"},{"text":"使用Chai","type":"link","path":"Testing/using-chai.html"},{"text":"测试组件","type":"link","path":"Testing/components.html","children":[{"text":"检验方法和属性","type":"link","path":"Testing/verify.html"},{"text":"注入依赖和DOM更改","type":"link","path":"Testing/injecting-dependencies.html"},{"text":"覆盖测试的组件","type":"link","path":"Testing/overriding.html"},{"text":"测试异步操作","type":"link","path":"Testing/async.html"},{"text":"重构难以测试的代码","type":"link","path":"Testing/refactor.html"}]},{"text":"测试服务","type":"link","path":"Testing/services.html","children":[{"text":"服务测试策略","type":"link","path":"Testing/strategies.html"},{"text":"测试HTTP请求","type":"link","path":"Testing/http.html"},{"text":"使用MockBackend","type":"link","path":"Testing/mockbackend.html"},{"text":"替代HTTP Mock策略","type":"link","path":"Testing/alt-http-mocking.html"},{"text":"测试JSONP和XHR后端","type":"link","path":"Testing/json-xhr.html"},{"text":"异步执行测试","type":"link","path":"Testing/async -execution.html"}]},{"text":"测试Redux","type":"link","path":"Testing/redux.html","children":[{"text":"测试简单的Action","type":"link","path":"Testing/simple-actions.html"},{"text":"测试复杂的Action","type":"link","path":"Testing/complex-actions.html"},{"text":"测试Reducers","type":"link","path":"Testing/reducers.html"},{"text":"Afterthoughts","type":"link","path":"Testing/after-thoughts.html"}]}]},{"text":"项目设置","type":"link","path":"Project-setup/project-setup.html","children":[{"text":"Webpack","type":"link","path":"Project-setup/webpack.html"},{"text":"安装和使用","type":"link","path":"Project-setup/installation_and_usage.html"},{"text":"Loaders","type":"link","path":"Project-setup/loaders.html"},{"text":"插件","type":"link","path":"Project-setup/plugins.html"},{"text":"概要","type":"link","path":"Project-setup/summary.html"},{"text":"NPM脚本集成","type":"link","path":"Project-setup/npm_scripts_integration.html"}]},{"text":"Angular CLI","type":"link","path":"Angular-CLI/cli.html","children":[{"text":"创建","type":"link","path":"Angular-CLI/setup.html"},{"text":"创建新应用程序","type":"link","path":"Angular-CLI/creating-an-app.html"},{"text":"启动应用","type":"link","path":"Angular-CLI/serving-the-app.html"},{"text":"创建组件","type":"link","path":"Angular-CLI/creating-components.html"},{"text":"创建路由","type":"link","path":"Angular-CLI/creating-routes.html"},{"text":"创建其他东西","type":"link","path":"Angular-CLI/creating-other-things.html"},{"text":"测试","type":"link","path":"Angular-CLI/testing.html"},{"text":"Linting","type":"link","path":"Angular-CLI/linting.html"},{"text":"CLI命令概述","type":"link","path":"Angular-CLI/command-overview.html"},{"text":"添加第三方库","type":"link","path":"Angular-CLI/adding-third-party-libraries.html"},{"text":"集成现有应用程序","type":"link","path":"Angular-CLI/init.html"}]},{"text":"Angular 中的无障碍","type":"link","path":"a11y/a11y.html","children":[{"text":"为什么需要无障碍","type":"link","path":"a11y/why-a11y.html"}]},{"text":"Angular 中的国际化","type":"link","path":"i18n/i18n.html","children":[{"text":"过程什么样的， 如何参与？","type":"link","path":"i18n/process-and-roles.html"},{"text":"在我们的模板中标记文字","type":"link","path":"i18n/marking-text-in -templates.html"},{"text":"使用Angular CLI提取翻译文本","type":"link","path":"i18n/translation-text-extraction.html"},{"text":"如何导入已完成的翻译文件","type":"link","path":"i18n/import -translation - files.html ","children":[{"text":"使用AoT编译器","type":"link","path":"i18n/import -using - aot.html "},{"text":"使用JiT编译器","type":"link","path":"i18n/import -using - jit.html "}]}]},{"text":"词汇表","type":"link","path":"glossary.html"},{"text":"最佳实践与填坑的积累⚡️","type":"link","path":"practice.html"},{"text":"进一步阅读和参考","type":"link","path":"further-reading.html"}]}},"config":{"timezone":"UTC","root":"/","time_format":"HH:mm:ss","theme":"../node_modules/hexo-theme-doc","theme_config":{"swagger_ui":{"version":2,"permalinks":true,"api_explorer":true,"download":"Download specification","show_extensions":false,"deep_linking":true,"display_operation_id":false,"doc_expansion":"none"},"search":{"skip":false,"background":false,"route":"/lunr.json"},"favicon":"images/favicon.ico","google_analytics":"UA-85094676-2"}}}</script>

    <div id="react-navigation-root"><div class="doc-navigation" data-reactroot=""><nav class="doc-navbar"><a href="/index.html" class="doc-navbar__logo"><img src="/images/logo.png" class="doc-navbar__logo__img"><span class="doc-navbar__logo__text">Angular</span></a><i class="dc-icon dc-icon--close dc-icon--interactive doc-sidebar-close doc-navbar__sidebar-close doc-navbar__sidebar-close--desktop"></i><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-navbar__sidebar-toggle"></i></nav><nav class="doc-sidebar"><div class="doc-sidebar__vertical-menu"><i class="dc-icon dc-icon--menu dc-icon--interactive doc-sidebar-toggle doc-sidebar-toggle--primary doc-sidebar__vertical-menu__item"></i><i class="dc-icon dc-icon--search dc-icon--interactive doc-sidebar__vertical-menu__item doc-sidebar__vertical-menu__item--primary"></i></div><div class="doc-sidebar-content"><div class="doc-sidebar__search-form"></div><ul class="doc-sidebar-list"></ul></div></nav></div></div>
    <div class="doc-content">
  <div class="dc-page">
    <div class="dc-card">
      <div id="react-search-results-root"></div>
      <div id="page-content" class="doc-formatting">
        <h1 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h1><p>So far, we have discussed how zones are created, forked and how they maintain their state across asynchronous operations. Zones are nested at runtime in the same way that execution stack frames are nested (but usually with lower depth.) There is one zone which is special in the context of nesting, and it is the top most zone. When that zone exists the execution transitions from JavaScript to native host environment. (Another way of saying it is that when the top most execution stack frame exits the control is returned to the native code.) We will call topmost zone a Task.</p>
<p>A task is special because knowing when a task is about to exit is useful in these circumstances:</p>
<ul>
<li>Frameworks  know when to render the UI.</li>
<li>Measuring enter/leave allows knowing total script/task time.</li>
<li>Exiting returning execution to native code allows rendering or doing I/O operations. (Knowing when it is about to happen allows for transactional behavior, ie doing things before rendering and or I/O.)</li>
</ul>
<p>Corollary to knowing when the task enters/leaves, is to know when an API call creates a Task which will/may execute in the future.</p>
<ul>
<li>Test frameworks can enforce sync tests by throwing on task creation.</li>
<li>Test frameworks can auto detect async tests and wait for its completion by waiting until all of the scheduled tasks have been executed.</li>
<li>Long stack traces across async boundaries, by tracking task scheduling.</li>
<li>Tracking user perceived actions by tracking when async tasks triggered by user complete.</li>
</ul>
<p>There are three kinds of tasks of interest:</p>
<ol>
<li>MicroTask: A microtask is work which will execute as soon as possible on empty stack frame. A microtask is guaranteed to run before host environment performs rendering or I/O operations. A microtask queue must be empty before another MacroTask or EventTask runs. (i.e. Promise.then() executes in microtask)</li>
<li>MacroTask: Macro tasks are interleaved with rendering and I/O operations of the host environment. (ie setTimeout, setInterval, etc..) Macro tasks are guaranteed to run at least once or canceled (some can run repeatedly such as setInterval). Macro tasks have an implied execution order.</li>
<li>EventTask: Event tasks are similar to macro tasks, but unlike macro tasks they may never run. When an EventTask is run, it pre-empts whatever the next task is the macro task queue. Event tasks do not create a queue. (i.e. user click, mousemove, XHR state change.)</li>
</ol>
<table>
<thead>
<tr>
<th>Type</th>
<th>Scheduled</th>
<th>Execution</th>
</tr>
</thead>
<tbody>
<tr>
<td>MicroTask</td>
<td>Microtasks are scheduled by promisses whenever they need to invoke the thenCallback.promise.then(thenCallback).</td>
<td>The execution of the thenCallback runs inside a microtask. Once the microtask is scheduled it can not be canceled and it is guaranteed to run exactly once.</td>
</tr>
<tr>
<td>MacroTask</td>
<td>Macro tasks are scheduled by user code using explicit API such as setTimeout(callback), setInterval(callback), etc..</td>
<td>The execution of the callback runs inside a macrotask after any rendering and I/O operations has completed. Once a macro task is completed the microtask queue is drained before the execution is handed to the host environment for more rendering and I/O operations.</td>
</tr>
<tr>
<td>EventTask</td>
<td>Event tasks are scheduled using addEventListener(‘click’, eventCallback), or similar mechanisms.</td>
<td>The execution of the event task may never happen, come at an unpredictable time, and can occur more than once, therefore there is no way to know how many times it will be executed.</td>
</tr>
</tbody>
</table>
<p>Why is this useful:</p>
<ul>
<li>Knowing when a task has executed and a microtask queue is empty allows frameworks to know when it is time to render the UI.</li>
<li>Enforcing that no tasks are scheduled allows test frameworks to ensure that the test is synchronous (and hence fast and non-flaky).</li>
<li>Tracking when all scheduled tasks are executed allows a test framework to know when an asynchronous test has completed.</li>
<li>Tracking tasks which originated from a user action and waiting until all scheduled tasks are executed allows application to track perceived user latency of that action.</li>
<li>Knowing when all outstanding tasks are executed allows end-to-end test frameworks to know how long to wait before asserting expectations and proceeding with the next step. (This makes the end-to-end tests faster, and reduces flakiness.)</li>
</ul>
<p>Another way to think about the need for tasks is that without task the above behaviors are not possible to implement.</p>

        <div id="react-support-footer-root"></div>
      </div>
    </div>
  </div>
</div>

    
<script>
  if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-85094676-2', 'auto');
    ga('send', 'pageview');
  }
</script>



    

    <!-- js vendors -->
    <script src="//code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/lunr.js/2.1.0/lunr.min.js"></script>

    <!-- js source  -->
    <script src="/script/doc.js"></script>

    

  </body>
</html>
